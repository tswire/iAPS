var freeaps_determineBasal;(()=>{var e={5546:(e,r,a)=>{var t=a(6880);function o(e,r){r||(r=0);var a=Math.pow(10,r);return Math.round(e*a)/a}function n(e,r){return"mmol/L"===r.out_units?o(.0555*e,1):Math.round(e)}var i="",s="",l="",u="",d="",m="",c="",p="",b="",g="",f="",h="",v=1,B=1,_=1,M=1,S=1;function y(e,r,a){"bg"==a?(polyX=[50,60,80,90,100,110,150,180,200],polyY=[-.5,-.5,-.3,-.2,0,0,.5,.7,.7]):"delta"==a&&(polyX=[2,7,12,16,20],polyY=[0,0,.4,.7,.7]);var t=polyX.length-1,o=polyX[0],n=polyY[0],i=polyX[t],s=polyY[t],l=1,u=1,d=1,m=o;if(o>e)i=polyX[1],l=(u=n)+((s=polyY[1])-u)/(i-(d=o))*(e-d);else if(i<e)o=polyX[t-1],l=(u=n=polyY[t-1])+(s-u)/(i-(d=o))*(e-d);else for(var c=0;c<=t;c++){if(o=polyX[c],n=polyY[c],o==e){l=n;break}if(o>e){l=u+(n-u)/(o-(d=m))*(e-d);break}u=n,m=o}return l*="delta"==a?r.delta_ISFrange_weight:e>100?r.higher_ISFrange_weight:r.lower_ISFrange_weight}function x(e,r,a,t,n,i,s,l,u){console.error("check ratio "+o(e,2)+" against autoISF min: "+r+" and autoISF max: "+a),e<r?(b=" (lmtd.min)",c="weakest autoISF factor "+o(e,2)+" limited by autoISF_min "+r,console.error(c),e=r):e>a&&(b=" (lmtd.max)",c="strongest autoISF factor "+o(e,2)+" limited by autoISF_max "+a,console.error(c),e=a);var d=1;return s&&i.temptargetSet&&l>u?(d=e*t,n=" (exerciseMode)",console.error("autoISF adjusts sens "+t+", instead of profile.sens "+i.sens),g=n):e>=1?(d=Math.max(e,t),e>=t&&(n="")):(d=Math.min(e,t),e<=t&&(n="")),c="final ISF factor "+o(d,2)+n,console.error(c),d}e.exports=function(e,r,a,I,F,T,w,C,D,O,G,R,U,A){var E=0,P="",k="",j="",q="",W="",z=0,N=0,L=0,X=0,Y=0,H=0;const Z=A.tddYtd,$=A.tdd7d,J=A.hbt,K=A.isEnabled;function Q(e,r){var a=e.getTime();return new Date(a+36e5*r)}function V(e){var r=I.bolus_increment;.025!=r&&(r=.05);var a=e/r;return a>=1?o(Math.floor(a)*r,5):0}function ee(e){function r(e){return e<10&&(e="0"+e),e}return r(e.getHours())+":"+r(e.getMinutes())+":00"}function re(e,r){var a=new Date("1/1/1999 "+e),t=new Date("1/1/1999 "+r);return(a.getTime()-t.getTime())/36e5}function ae(e,r){var a=0,t=r,o=(e-r)/36e5,n=0,i=o,s=0;do{if(o>0){var l=ee(t);U[0].rate;for(let e=0;e<U.length;e++){var u=U[e].start;if(l==u){if(e+1<U.length){o>=(s=re(U[e+1].start,U[e].start))?n=s:o<s&&(n=o)}else if(e+1==U.length){let r=U[0].start;o>=(s=24-re(U[e].start,r))?n=s:o<s&&(n=o)}a+=V(U[e].rate*n),o-=n,t=Q(t,n)}else if(l>u)if(e+1<U.length){var d=U[e+1].start;l<d&&(o>=(s=re(d,l))?n=s:o<s&&(n=o),a+=V(U[e].rate*n),o-=n,t=Q(t,n))}else if(e==U.length-1){o>=(s=re("23:59:59",l))?n=s:o<s&&(n=o),a+=V(U[e].rate*n),o-=n,t=Q(t,n)}}}}while(o>0&&o<i);return a}if(G.length){let e=G.length-1;var te=new Date(G[e].timestamp),oe=new Date(G[0].timestamp);if("TempBasalDuration"==G[0]._type&&(oe=new Date),(E=(oe-te)/36e5)<23.9&&E>21)Y=ae(te,(ne=24-E,ie=te.getTime(),new Date(ie-36e5*ne))),q="24 hours of data is required for an accurate tdd calculation. Currently only "+E.toPrecision(3)+" hours of pump history data are available. Using your pump scheduled basals to fill in the missing hours. Scheduled basals added: "+Y.toPrecision(5)+" U. ";else E<21?(dynISFenabled=!1,enableDynamicCR=!1):q=""}else console.log("Pumphistory is empty!"),dynISFenabled=!1,enableDynamicCR=!1;var ne,ie,se=0,le=0;o((new Date(Se).getTime()-T.lastBolusNormalTime)/6e4,1);for(let e=0;e<G.length;e++)if("Bolus"==G[e]._type&&(X+=G[e].amount,0==se&&G[e].amount>=I.iTime_Start_Bolus)){se=t(G[e].amount,I);var ue=new Date(G[e].timestamp);le=o((new Date-ue)/36e5*60)}for(let e=1;e<G.length;e++)if("TempBasal"==G[e]._type&&G[e].rate>0){z=e,H=G[e].rate;var de=G[e-1]["duration (min)"]/60,me=de,ce=new Date(G[e-1].timestamp),pe=ce;do{if(e--,0==e){pe=new Date;break}if("TempBasal"==G[e]._type||"PumpSuspend"==G[e]._type){pe=new Date(G[e].timestamp);break}}while(e>0);var be=(pe-ce)/36e5;be<me&&(de=be),L+=V(H*de),e=z}for(let e=0;e<G.length;e++)if(0,0==G[e]["duration (min)"]||"PumpResume"==G[e]._type){let r=new Date(G[e].timestamp),a=r,t=e;do{if(t>0&&(--t,"TempBasal"==G[t]._type)){a=new Date(G[t].timestamp);break}}while(t>0);(a-r)/36e5>0&&(Y+=ae(a,r))}for(let e=G.length-1;e>0;e--)if("TempBasalDuration"==G[e]._type){let r=G[e]["duration (min)"]/60,a=new Date(G[e].timestamp);var ge=a;let t=e;do{if(--t,t>=0&&("TempBasal"==G[t]._type||"PumpSuspend"==G[t]._type)){ge=new Date(G[t].timestamp);break}}while(t>0);if(0==e&&"TempBasalDuration"==G[0]._type&&(ge=new Date,r=G[e]["duration (min)"]/60),(ge-a)/36e5-r>0){Y+=ae(ge,Q(a,r))}}var fe={TDD:o(N=X+L+Y,5),bolus:o(X,5),temp_basal:o(L,5),scheduled_basal:o(Y,5)},he=N;E>21?(k=". Bolus insulin: "+X.toPrecision(5)+" U",j=". Temporary basal insulin: "+L.toPrecision(5)+" U",P=". Insulin with scheduled basal rate: "+Y.toPrecision(5)+" U",W=q+(" TDD past 24h is: "+N.toPrecision(5)+" U")+k+j+P,tddReason=", TDD, 24h: "+o(N,1)+", ytd: "+o(Z,1)+", 7dØ: "+o($,1),console.error(W)):tddReason=", TDD: Not enough pumpData (< 21h)";var ve={},Be=new Date;if(O&&(Be=new Date(O)),void 0===I||void 0===I.current_basal)return ve.error="Error: could not get current basal rate",ve;var _e=t(I.current_basal,I),Me=_e,Se=new Date;O&&(Se=O);var ye,xe=new Date(e.date),Ie=o((Se-xe)/60/1e3,1),Fe=e.glucose,Te=e.noise;ye=n(e.delta,I);var we=Math.min(e.delta,e.short_avgdelta),Ce=Math.min(e.short_avgdelta,e.long_avgdelta),De=Math.max(e.delta,e.short_avgdelta,e.long_avgdelta);(Fe<=10||38===Fe||Te>=3)&&(ve.reason="CGM is calibrating, in ??? state, or noise is high");if(Ie>12||Ie<-5?ve.reason="If current system time "+Se+" is correct, then BG data is too old. The last BG data was read "+Ie+"m ago at "+xe:Fe>60&&e.cgmFlatMinutes>89&&(e.last_cal&&e.last_cal<3?ve.reason="CGM was just calibrated":ve.reason="Error: CGM data was suspiciously flat for the past ~"+o(e.cgmFlatMinutes,1)+"m"),Fe<=10||38===Fe||Te>=3||Ie>12||Ie<-5||Fe>60&&e.cgmFlatMinutes>89)return r.rate>Me?(ve.reason+=". Replacing high temp basal of "+r.rate+" with neutral temp of "+Me,ve.deliverAt=Be,ve.temp="absolute",ve.duration=30,ve.rate=Me,ve):0===r.rate&&r.duration>30?(ve.reason+=". Shortening "+r.duration+"m long zero temp to 30m. ",ve.deliverAt=Be,ve.temp="absolute",ve.duration=30,ve.rate=0,ve):(ve.reason+=". Temp "+r.rate+" <= current basal "+o(Me,2)+"U/hr; doing nothing. ",ve);var Oe,Ge,Re,Ue,Ae=I.max_iob;if(void 0!==I.min_bg&&(Ge=I.min_bg),void 0!==I.max_bg&&(Re=I.max_bg),void 0!==I.enableSMB_high_bg_target&&(Ue=I.enableSMB_high_bg_target),void 0===I.min_bg||void 0===I.max_bg)return ve.error="Error: could not determine target_bg. ",ve;Oe=(I.min_bg+I.max_bg)/2;var Ee="",Pe=I.exercise_mode||I.high_temptarget_raises_sensitivity,ke=100,je=160;if(I.half_basal_exercise_target&&(je=I.half_basal_exercise_target),K&&(je=J),Pe&&I.temptargetSet&&Oe>ke||I.low_temptarget_lowers_sensitivity&&I.temptargetSet&&Oe<ke){var qe=je-ke;sensitivityRatio=qe*(qe+Oe-ke)<=0?I.autosens_max:qe/(qe+Oe-ke),sensitivityRatio=Math.min(sensitivityRatio,I.autosens_max),sensitivityRatio=o(sensitivityRatio,2),Ee="from TT modifier",f+=", Ratio TT: "+sensitivityRatio,process.stderr.write("Sensitivity ratio set to "+sensitivityRatio+" based on temp target of "+Oe+"; ")}else void 0!==F&&F&&(sensitivityRatio=F.ratio,Ee="from Autosens",process.stderr.write("Autosens ratio: "+sensitivityRatio+"; "));if(sensitivityRatio&&(Me=I.current_basal*sensitivityRatio,(Me=t(Me,I))!==_e?process.stderr.write("Adjusting basal from "+_e+" to "+Me+"; "):process.stderr.write("Basal unchanged: "+Me+"; ")),I.temptargetSet);else if(void 0!==F&&F&&(I.sensitivity_raises_target&&F.ratio<1||I.resistance_lowers_target&&F.ratio>1)){Ge=o((Ge-60)/F.ratio)+60,Re=o((Re-60)/F.ratio)+60;var We=o((Oe-60)/F.ratio)+60;Oe===(We=Math.max(80,We))?process.stderr.write("target_bg unchanged: "+We+"; "):process.stderr.write("target_bg from "+Oe+" to "+We+"; "),Oe=We}var ze=200,Ne=200,Le=200;if(e.noise>=2){var Xe=Math.max(1.1,I.noisyCGMTargetMultiplier);Math.min(250,I.maxRaw);ze=o(Math.min(200,Ge*Xe)),Ne=o(Math.min(200,Oe*Xe)),Le=o(Math.min(200,Re*Xe)),process.stderr.write("Raising target_bg for noisy / raw CGM data, from "+Oe+" to "+Ne+"; "),Ge=ze,Oe=Ne,Re=Le}var Ye=Ge-.5*(Ge-40),He=o(I.sens,1),Ze=I.sens;void 0!==F&&F&&((Ze=o(Ze=I.sens/sensitivityRatio,1))!==He?process.stderr.write("ISF from "+n(He,I)+" to "+n(Ze,I)):process.stderr.write("ISF unchanged: "+n(Ze,I))),console.error("CR:"+I.carb_ratio),console.error("----------------------------------"),console.error(" start autoISF"),console.error("----------------------------------");var $e=!0,Je=!1,Ke=r.rate,Qe=I.b30_duration,Ve=Qe+1;if(console.error("B30 enabled: "+I.use_B30),I.use_B30&&I.use_autoisf){var er=I.iTime_Start_Bolus,rr=I.iTime_target,ar=I.b30_upperBG,tr=I.b30_upperdelta,or=I.b30_factor,nr=!1;I.temptargetSet&&(nr=!0);var ir=le;0==ir&&(ir=1);var sr=se;console.error("B30 last bolus above limit of "+er+"U was "+sr+"U, "+ir+"m ago"),sr>=er&&ir<=Qe&&nr&&Oe==rr&&(Ve=ir,Je=!0,console.error("B30 iTime is running : "+Ve+"m because manual bolus ("+sr+") >= Minimum Start Bolus size ("+er+") and EatingSoon TT set at "+n(rr,I))),console.error("B30 Activation: "+Je),console.error("B30 TTset: "+nr+", at "+Oe+", last Bolus of "+sr+"U, "+ir+"m ago. iTime remaining: "+(Qe-Ve)+"m."),Je&&(e.delta<=tr&&Fe<ar&&($e=!1),Ve<=Qe&&(Ke=t(Me*or,I),h="AIMI B30, Temp "+Ke+"U/hr for "+(Qe-Ve)+"m, "))}var lr=function(e,r,a){if(e.use_autoisf&&e.iob_threshold>0&&e.iob_threshold<r[0].iob)return s=", autoISF-SMB disabled:, IOB: "+o(r[0].iob,2)+", > threshold: "+e.iob_threshold+", maxIOB: "+e.max_iob,console.error(s),"iobTH";if(!a)return s=", autoISF-SMB disabled:, B30 running","AIMI B30";var t=n(e.min_bg,e);return e.use_autoisf&&e.temptargetSet&&e.enableSMB_EvenOn_OddOff||e.use_autoisf&&e.min_bg==e.max_bg&&e.enableSMB_EvenOn_OddOff_always?(e.temptargetSet?msgType="TempTarget ":msgType="profile target ","mmol/L"==e.out_units?(evenTarget=o(10*t,0)%2==0,msgUnits=" has ",msgTail=" decimal"):(evenTarget=t%2==0,msgUnits=" is ",msgTail=" number"),evenTarget?msgEven="even":msgEven="odd",evenTarget?(console.error("SMB enabled - "+msgType+t+msgUnits+msgEven+msgTail),console.error("enableSMB_EvenOn_OddOff = "+e.enableSMB_EvenOn_OddOff+", enableSMB_EvenOn_OddOff_alway = "+e.enableSMB_EvenOn_OddOff_always),e.temptargetSet&&t<100?(console.error("Full Loop enabled, SMB enforced"),s=", autoISF-SMB enabled:, even TT","enforced"):(s=", autoISF-SMB enabled:, even Target","enabled")):(console.error("SMB disabled - "+msgType+t+msgUnits+msgEven+msgTail),s=", autoISF-SMB disabled:, odd Target","blocked")):"oref"}(I,a,$e),ur=!0;if(C&&"oref"!=lr?("blocked"!=lr&&"AIMI B30"!=lr||(ur=!1),console.error("loopSMB function overriden with autoISF target toggle, enableSMB = "+ur)):(ur=function(e,r,a,t,o,i){return r?!e.allowSMB_with_high_temptarget&&e.temptargetSet&&o>100?(console.error("SMB disabled due to high temptarget of "+o),!1):!0===a.bwFound&&!1===e.A52_risk_enable?(console.error("SMB disabled due to Bolus Wizard activity in the last 6 hours."),!1):!0===e.enableSMB_always?(a.bwFound?console.error("Warning: SMB enabled within 6h of using Bolus Wizard: be sure to easy bolus 30s before using Bolus Wizard"):console.error("SMB enabled due to enableSMB_always"),!0):!0===e.enableSMB_with_COB&&a.mealCOB?(a.bwCarbs?console.error("Warning: SMB enabled with Bolus Wizard carbs: be sure to easy bolus 30s before using Bolus Wizard"):console.error("SMB enabled for COB of"+a.mealCOB),!0):!0===e.enableSMB_after_carbs&&a.carbs?(a.bwCarbs?console.error("Warning: SMB enabled with Bolus Wizard carbs: be sure to easy bolus 30s before using Bolus Wizard"):console.error("SMB enabled for 6h after carb entry"),!0):!0===e.enableSMB_with_temptarget&&e.temptargetSet&&o<100?(a.bwFound?console.error("Warning: SMB enabled within 6h of using Bolus Wizard: be sure to easy bolus 30s before using Bolus Wizard"):console.error("SMB enabled for temptarget of "+n(o,e)),!0):!0===e.enableSMB_high_bg&&null!==i&&t>=i?(console.error("Checking BG to see if High for SMB enablement."),console.error("Current BG",t," | High BG ",i),a.bwFound?console.error("Warning: High BG SMB enabled within 6h of using Bolus Wizard: be sure to easy bolus 30s before using Bolus Wizard"):console.error("High BG detected. Enabling SMB."),!0):(console.error("SMB disabled (no enableSMB preferences active or no condition satisfied)"),!1):(console.error("SMB disabled (!microBolusAllowed)"),!1)}(I,C,T,Fe,Oe,Ue),console.error("loopSMB function returns enableSMB = "+ur)),Ze=function(e,r,a,t,f,h,I,F,T,w,C,D){if(!t.use_autoisf)return console.error("autoISF disabled in Preferences"),i+=", autoISF, disabled",e;if(t.autoISF_off_Sport&&(t.high_temptarget_raises_sensitivity||t.exercise_mode)&&t.temptargetSet&&a>D)return console.error("autoISF disabled due to exercise"),i+=", autoISF, disabled (exercise)",e;const O=f.dura_p,G=f.delta_pl,R=f.delta_pn,U=f.r_squ,A=f.bg_acceleration,E=f.a_0,P=f.a_1,k=f.a_2,j=f.dura_ISF_minutes,q=f.dura_ISF_average;var W=t.autoISF_min,z=t.autoISF_max,N=!1,L=e,X=a+10-q,Y=f.pp_debug;if("bg_acceleration: "+o(A,3)+", PF-minutes: "+O+", PF-corr: "+o(U,4)+", PF-nextDelta: "+n(R,t)+", PF-lastDelta: "+n(G,t)+", regular Delta: "+n(f.delta,t),console.error(Y),t.enable_BG_acceleration){var H=U;if(0!=k&&H>=.9){var Z=-P/2/k*5,$=o(E-Z*Z/25*k,1);(Z=o(Z,1))>0&&A<0?(p="predicts a Max of "+n($,t)+", in about "+Math.abs(Z)+"min",console.error("Parabolic fit "+p)):Z>0&&A>0?(p="predicts a Min of "+n($,t)+", in about "+Math.abs(Z)+"min",console.error("Parabolic fit "+p)):Z<0&&A<0?(p="saw Max of "+n($,t)+", about "+Math.abs(Z)+"min ago",console.error("Parabolic fit "+p)):Z<0&&A>0&&(p="saw Min of "+n($,t)+", about "+Math.abs(Z)+"min ago",console.error("Parabolic fit "+p))}if(H<.9)p="acce_ISF by-passed, as correlation, "+o(H,2)+", is too low",console.error("Parabolic fit "+p),m+=", Parabolic Fit, "+p;else{var J=10*(H-.9),K=1,Q=1;f.glucose<t.target_bg?A>0?(A>1&&(K=.5),Q=t.bgBrake_ISF_weight):A<0&&(Q=t.bgAccel_ISF_weight):A<0?Q=t.bgBrake_ISF_weight:A>0&&(Q=t.bgAccel_ISF_weight),(v=1+A*K*Q*J)<0&&(v=.1),console.error(m+"acce_ISF adaptation is "+o(v,2)),1!=v&&(N=!0,m+=", Parabolic Fit, "+p+", acce-ISF Ratio: "+o(v,2))}}else console.error("autoISF BG accelertion adaption disabled in Preferences");i+=s+m+", autoISF",B=1+y(100-X,t,"bg"),console.error("bg_ISF adaptation is "+o(B,2));var V=1,ee=1;if(B<1)return V=Math.min(B,v),v>1?(c="bg-ISF adaptation lifted to "+o(V=B*v,2)+", as BG accelerates already",console.error(c),i+=", bg-ISF Ratio: "+o(V,2)+"(accel.)"):i+=", bg-ISF Ratio: "+o(V,2)+"(minimal)",ee=x(V,W,z,T,r,t,C,a,D),L=Math.min(720,o(t.sens/ee,1)),i+=", bg-ISF Ratio: "+o(ee,2),L;B>1&&(N=!0,i+=", bg-ISF Ratio: "+o(B,2));var re=f.delta;t.enable_pp_ISF_always||t.pp_ISF_hours>=(I-h.lastCarbTime)/1e3/3600?deltaType="pp":deltaType="delta",X>0?console.error(deltaType+"_ISF adaptation by-passed as average glucose < "+a+"+10"):f.short_avgdelta<0?console.error(deltaType+"_ISF adaptation by-passed as no rise or too short lived"):"pp"==deltaType?(M=1+Math.max(0,re*t.pp_ISF_weight),console.error("pp_ISF adaptation is "+o(M,2)),u=", pp-ISF Ratio: "+o(M,2),1!=M&&(N=!0)):(_=y(re,t,"delta"),X>-20&&(_*=.5),_=1+_,console.error("delta_ISF adaptation is "+o(_,2)),d=", Δ-ISF Ratio: "+o(_,2),1!=_&&(N=!0));var ae=t.dura_ISF_weight;h.mealCOB>0&&!t.enableautoisf_with_COB?console.error("dura_ISF by-passed; preferences disabled mealCOB of "+o(h.mealCOB,1)):j<10?console.error("dura_ISF by-passed; BG is only "+j+"m at level "+q):q<=a?console.error("dura_ISF by-passed; avg. glucose "+q+" below target "+n(a,t)):(S+=j/60*(ae/a)*(q-a),N=!0,l=", Duration: "+j+", Avg: "+n(q,t)+", dura-ISF Ratio: "+o(S,2),console.error("dura_ISF adaptation is "+o(S,2)+" because ISF "+e+" did not do it for "+o(j,1)+"m"));return N?(V=Math.max(S,B,_,v,M),console.error("autoISF adaption ratios:"),console.error("  dura "+o(S,2)),console.error("  bg "+o(B,2)),console.error("  delta "+o(_,2)),console.error("  pp "+o(M,2)),console.error("  accel "+o(v,2)),v<1&&(c="strongest ISF factor "+o(V,2)+" weakened to "+o(V*v,2)+" as bg decelerates already",console.error(c),V*=v),ee=x(V,W,z,T,r,t,C,a,D),L=o(t.sens/ee,1),i+=u+d+l+", final Ratio: "+o(ee,2)+g+b+", final ISF: "+n(t.sens,t)+"→"+n(L,t),L):(i+=", not modified",console.error("autoISF does not modify"),L)}(Ze,Ee,Oe,I,e,T,O,0,sensitivityRatio,0,Pe,ke),console.error("----------------------------------"),console.error(" end autoISF"),console.error("----------------------------------"),void 0===a)return ve.error="Error: iob_data undefined. ",ve;var dr,mr=a;if(a.length,a.length>1&&(a=mr[0]),void 0===a.activity||void 0===a.iob)return ve.error="Error: iob_data missing some property. ",ve;var cr=((dr=void 0!==a.lastTemp?o((new Date(Se).getTime()-a.lastTemp.date)/6e4):0)+r.duration)%30;if(console.error("currenttemp:"+r.rate+" lastTempAge:"+dr+"m, tempModulus:"+cr+"m"),ve.temp="absolute",ve.deliverAt=Be,C&&r&&a.lastTemp&&r.rate!==a.lastTemp.rate&&dr>10&&r.duration)return ve.reason="Warning: currenttemp rate "+r.rate+" != lastTemp rate "+a.lastTemp.rate+" from pumphistory; canceling temp",w.setTempBasal(0,0,I,ve,r);if(r&&a.lastTemp&&r.duration>0){var pr=dr-a.lastTemp.duration;if(pr>5&&dr>10)return ve.reason="Warning: currenttemp running but lastTemp from pumphistory ended "+pr+"m ago; canceling temp",w.setTempBasal(0,0,I,ve,r)}var br=o(-a.activity*Ze*5,2),gr=o(6*(we-br));gr<0&&(gr=o(6*(Ce-br)))<0&&(gr=o(6*(e.long_avgdelta-br)));var fr=Fe,hr=(fr=a.iob>0?o(Fe-a.iob*Ze):o(Fe-a.iob*Math.min(Ze,I.sens)))+gr;if(void 0===hr||isNaN(hr))return ve.error="Error: could not calculate eventualBG. Sensitivity: "+Ze+" Deviation: "+gr,ve;var vr=function(e,r,a){return o(a+(e-r)/24,1)}(Oe,hr,br);ve={temp:"absolute",bg:n(Fe,I),tick:ye,eventualBG:hr,insulinReq:0,reservoir:D,deliverAt:Be,sensitivityRatio,TDD:he,insulin:fe};var Br=[],_r=[],Mr=[],Sr=[];Br.push(Fe),_r.push(Fe),Sr.push(Fe),Mr.push(Fe);var yr=I.enableUAM,xr=0,Ir=0;xr=o(we-br,1);var Fr=o(we-br,1);csf=Ze/I.carb_ratio,console.error("profile.sens:"+n(I.sens,I)+", sens:"+n(Ze,I)+", CSF:"+o(csf,1));var Tr=o(30*csf*5/60,1);xr>Tr&&(console.error("Limiting carb impact from "+xr+" to "+Tr+"mg/dL/5m (30g/h)"),xr=Tr);var wr=3;sensitivityRatio&&(wr/=sensitivityRatio);var Cr=wr;if(T.carbs){wr=Math.max(wr,T.mealCOB/20);var Dr=o((new Date(Se).getTime()-T.lastCarbTime)/6e4),Or=(T.carbs-T.mealCOB)/T.carbs;Cr=o(Cr=wr+1.5*Dr/60,1),console.error("Last carbs "+Dr+" minutes ago; remainingCATime:"+Cr+"hours; "+o(100*Or)+"% carbs absorbed")}var Gr=Math.max(0,xr/5*60*Cr/2)/csf,Rr=90,Ur=1;I.remainingCarbsCap&&(Rr=Math.min(90,I.remainingCarbsCap)),I.remainingCarbsFraction&&(Ur=Math.min(1,I.remainingCarbsFraction));var Ar=1-Ur,Er=Math.max(0,T.mealCOB-Gr-T.carbs*Ar),Pr=(Er=Math.min(Rr,Er))*csf*5/60/(Cr/2),kr=o(T.slopeFromMaxDeviation,2),jr=o(T.slopeFromMinDeviation,2),qr=Math.min(kr,-jr/3),Wr=0;0===xr?Ir=0:!0===I.floating_carbs?(Ir=Math.min(60*Cr/5/2,Math.max(0,T.carbs*csf/xr)),Wr=Math.min(60*Cr/5/2,Math.max(0,T.mealCOB*csf/xr)),T.carbs>0&&(i+=", Floating Carbs:, CID: "+o(Ir,1)+", MealCarbs: "+o(T.carbs,1)+", Not Floating:, CID: "+o(Wr,1)+", MealCOB: "+o(T.mealCOB,1),console.error("Floating Carbs CID: "+o(Ir,1)+" / MealCarbs: "+o(T.carbs,1)+" vs. Not Floating:"+o(Wr,1)+" / MealCOB:"+o(T.mealCOB,1)))):Ir=Math.min(60*Cr/5/2,Math.max(0,T.mealCOB*csf/xr)),console.error("Carb Impact:"+xr+"mg/dL per 5m; CI Duration:"+o(5*Ir/60*2,1)+"hours; remaining CI ("+o(Cr/2,2)+"h peak):",o(Pr,1)+"mg/dL per 5m");var zr,Nr,Lr,Xr,Yr,Hr=999,Zr=999,$r=999,Jr=Fe,Kr=999,Qr=999,Vr=999,ea=999,ra=hr,aa=Fe,ta=Fe,oa=0,na=[],ia=[];try{mr.forEach((function(e){var r=o(-e.activity*Ze*5,2),a=o(-e.iobWithZeroTemp.activity*Ze*5,2),t=xr*(1-Math.min(1,_r.length/12));ra=_r[_r.length-1]+r+t;var n=Sr[Sr.length-1]+a,i=Math.max(0,Math.max(0,xr)*(1-Br.length/Math.max(2*Ir,1))),s=Math.min(Br.length,12*Cr-Br.length),l=Math.max(0,s/(Cr/2*12)*Pr);i+l,na.push(o(l,0)),ia.push(o(i,0)),COBpredBG=Br[Br.length-1]+r+Math.min(0,t)+i+l;var u=Math.max(0,Fr+Mr.length*qr),d=Math.max(0,Fr*(1-Mr.length/Math.max(36,1))),m=Math.min(u,d);m>0&&(oa=o(5*(Mr.length+1)/60,1)),UAMpredBG=Mr[Mr.length-1]+r+Math.min(0,t)+m,_r.length<48&&_r.push(ra),Br.length<48&&Br.push(COBpredBG),Mr.length<48&&Mr.push(UAMpredBG),Sr.length<48&&Sr.push(n),COBpredBG<Kr&&(Kr=o(COBpredBG)),UAMpredBG<Qr&&(Qr=o(UAMpredBG)),ra<Vr&&(Vr=o(ra)),n<ea&&(ea=o(n));_r.length>18&&ra<Hr&&(Hr=o(ra)),ra>aa&&(aa=ra),(Ir||Pr>0)&&Br.length>18&&COBpredBG<Zr&&(Zr=o(COBpredBG)),(Ir||Pr>0)&&COBpredBG>aa&&(ta=COBpredBG),yr&&Mr.length>12&&UAMpredBG<$r&&($r=o(UAMpredBG)),yr&&UAMpredBG>aa&&UAMpredBG}))}catch(e){console.error("Problem with iobArray.  Optional feature Advanced Meal Assist disabled")}ve.predBGs={},_r.forEach((function(e,r,a){a[r]=o(Math.min(401,Math.max(39,e)))}));for(var sa=_r.length-1;sa>12&&_r[sa-1]===_r[sa];sa--)_r.pop();for(ve.predBGs.IOB=_r,Lr=o(_r[_r.length-1]),Sr.forEach((function(e,r,a){a[r]=o(Math.min(401,Math.max(39,e)))})),sa=Sr.length-1;sa>6&&!(Sr[sa-1]>=Sr[sa]||Sr[sa]<=Oe);sa--)Sr.pop();if(ve.predBGs.ZT=Sr,o(Sr[Sr.length-1]),T.mealCOB>0&&(xr>0||Pr>0)){for(Br.forEach((function(e,r,a){a[r]=o(Math.min(401,Math.max(39,e)))})),sa=Br.length-1;sa>12&&Br[sa-1]===Br[sa];sa--)Br.pop();ve.predBGs.COB=Br,Xr=o(Br[Br.length-1]),hr=Math.max(hr,o(Br[Br.length-1]))}if(xr>0||Pr>0){if(yr){for(Mr.forEach((function(e,r,a){a[r]=o(Math.min(401,Math.max(39,e)))})),sa=Mr.length-1;sa>12&&Mr[sa-1]===Mr[sa];sa--)Mr.pop();ve.predBGs.UAM=Mr,Yr=o(Mr[Mr.length-1]),Mr[Mr.length-1]&&(hr=Math.max(hr,o(Mr[Mr.length-1])))}ve.eventualBG=hr}console.error("UAM Impact:"+Fr+"mg/dL per 5m; UAM Duration:"+oa+"hours"),Hr=Math.max(39,Hr),Zr=Math.max(39,Zr),$r=Math.max(39,$r),zr=o(Hr);var la=T.mealCOB/T.carbs;Nr=o($r<999&&Zr<999?(1-la)*UAMpredBG+la*COBpredBG:Zr<999?(ra+COBpredBG)/2:$r<999?(ra+UAMpredBG)/2:ra),ea>Nr&&(Nr=ea),Jr=o(Jr=Ir||Pr>0?yr?la*Kr+(1-la)*Qr:Kr:yr?Qr:Vr);var ua=$r;if(ea<Ye)ua=($r+ea)/2;else if(ea<Oe){var da=(ea-Ye)/(Oe-Ye);ua=($r+($r*da+ea*(1-da)))/2}else ea>$r&&(ua=($r+ea)/2);if(ua=o(ua),T.carbs)if(!yr&&Zr<999)zr=o(Math.max(Hr,Zr));else if(Zr<999){var ma=la*Zr+(1-la)*ua;zr=o(Math.max(Hr,Zr,ma))}else zr=yr?ua:Jr;else yr&&(zr=o(Math.max(Hr,ua)));zr=Math.min(zr,Nr),process.stderr.write("minPredBG: "+n(zr,I)+" minIOBPredBG: "+n(Hr,I)+" minZTGuardBG: "+n(ea,I)),Zr<999&&process.stderr.write(" minCOBPredBG: "+n(Zr,I)),$r<999&&process.stderr.write(" minUAMPredBG: "+n($r,I)),console.error(" avgPredBG:"+n(Nr,I)+" COB/Carbs:"+T.mealCOB+"/"+T.carbs),ta>Fe&&(zr=Math.min(zr,ta)),ve.COB=T.mealCOB,ve.IOB=a.iob,ve.BGI=n(br,I),ve.insulinForManualBolus=0,ve.deviation=n(gr,I),ve.dura_ISFratio=o(S,2),ve.bg_ISFratio=o(B,2),ve.delta_ISFratio=o(_,2),ve.pp_ISFratio=o(M,2),ve.acce_ISFratio=o(v,2),ve.auto_ISFratio=o(I.sens/Ze,2),ve.ISF=n(Ze,I),ve.CR=o(I.carb_ratio,2),ve.TDD=o(he,1),ve.TDDytd=o(Z,1),ve.TDD7d=o($,1),ve.target_bg=n(Oe,I);var ca=function(e,r,a,t){if(!e.use_autoisf)return console.error("autoISF disabled, don't adjust SMB Delivery Ratio"),.5;var n=e.smb_delivery_ratio_bg_range;n<10&&(n/=.0555);var i=e.smb_delivery_ratio,s=Math.min(e.smb_delivery_ratio_min,e.smb_delivery_ratio_max),l=Math.max(e.smb_delivery_ratio_min,e.smb_delivery_ratio_max),u=a+e.smb_delivery_ratio_bg_range,d=i;return n>0&&(d=s+(l-s)*(r-a)/n,d=Math.max(s,Math.min(l,d))),"enforced"==t?(console.error("SMB delivery ratio set to "+o(Math.max(i,d),2)+" as max of fixed and interpolated values"),Math.max(i,d)):0==n?(console.error("SMB delivery ratio set to fixed value "+o(i,2)),i):r<=a?(console.error("SMB delivery ratio limited by minimum value "+o(s,2)),s):r>=u?(console.error("SMB delivery ratio limited by maximum value "+o(l,2)),l):(console.error("SMB delivery ratio set to interpolated value "+o(d,2)),d)}(I,Fe,Oe,lr);ve.SMBratio=o(ca,2);var pa="SMB Del.Ratio:, "+o(ca,2);ve.reason=h+pa+f+i+", Standard, COB: "+ve.COB+", Dev: "+ve.deviation+", BGI: "+ve.BGI+", ISF: "+ve.ISF+", CR: "+ve.CR+", Target: "+ve.target_bg+", minPredBG "+n(zr,I)+", minGuardBG "+n(Jr,I)+", IOBpredBG "+n(Lr,I),Xr>0&&(ve.reason+=", COBpredBG "+n(Xr,I)),Yr>0&&(ve.reason+=", UAMpredBG "+n(Yr,I)),ve.reason+=tddReason,ve.reason+="; ";var ba=fr;ba<40&&(ba=Math.min(Jr,ba));var ga=Ye-ba,fa=240,ha=240;if(T.mealCOB>0&&(xr>0||Pr>0)){for(sa=0;sa<Br.length;sa++)if(Br[sa]<Ge){fa=5*sa;break}for(sa=0;sa<Br.length;sa++)if(Br[sa]<Ye){ha=5*sa;break}}else{for(sa=0;sa<_r.length;sa++)if(_r[sa]<Ge){fa=5*sa;break}for(sa=0;sa<_r.length;sa++)if(_r[sa]<Ye){ha=5*sa;break}}ur&&Jr<Ye&&(console.error("minGuardBG "+n(Jr,I)+" projected below "+n(Ye,I)+" - disabling SMB"),ur=!1);var va=.2;void 0!==I.maxDelta_bg_threshold&&(va=Math.min(I.maxDelta_bg_threshold,.4),console.error("maxDelta threshold for BG-Jump to allow SMB's set to: "+100*va+"%")),De>va*Fe&&(console.error("maxDelta "+n(De,I)+" > "+100*va+"% of BG "+n(Fe,I)+" - disabling SMB"),ve.reason+="maxDelta "+n(De,I)+" > "+100*va+"% of BG "+n(Fe,I)+" - SMB disabled!, ",ur=!1),console.error("BG projected to remain above "+n(Ge,I)+" for "+fa+"minutes"),(ha<240||fa<60)&&console.error("BG projected to remain above "+n(Ye,I)+" for "+ha+"minutes");var Ba=ha,_a=I.current_basal*Ze*Ba/60,Ma=Math.max(0,T.mealCOB-.25*T.carbs),Sa=(ga-_a)/csf-Ma;if(_a=o(_a),Sa=o(Sa),console.error("naive_eventualBG: "+n(fr,I)+", bgUndershoot: "+n(ga,I)+", zeroTempDuration: "+Ba+", zeroTempEffect: "+_a+", carbsReq: "+Sa),"Could not parse clock data"==T.reason?console.error("carbsReq unknown: Could not parse clock data"):Sa>=I.carbsReqThreshold&&ha<=45&&(ve.carbsReq=Sa,ve.reason+=Sa+" add'l carbs req w/in "+ha+"m; "),Je&&Ve<=Qe)return ve.reason+="setting AIMI B30 Temp "+t(Ke,I)+"U/hr for "+(Qe-Ve)+"m ",ve.temp="absolute",ve.deliverAt=Be,ve.duration=Math.min(30,Qe-Ve),console.error("Forcing AIMI temp "+Ke+"U/hr"),w.setTempBasal(Ke,30,I,ve,r);var ya=0;if(Fe<Ye&&a.iob<20*-I.current_basal/60&&we>0&&we>vr)ve.reason+="IOB "+a.iob+" < "+o(20*-I.current_basal/60,2),ve.reason+=" and minDelta "+n(we,I)+" > expectedDelta "+n(vr,I)+"; ";else if(Fe<Ye||Jr<Ye)return ve.reason+="minGuardBG "+n(Jr,I)+"<"+n(Ye,I),ya=o(60*((ga=Oe-Jr)/Ze)/I.current_basal),ya=30*o(ya/30),ya=Math.min(120,Math.max(30,ya)),w.setTempBasal(0,ya,I,ve,r);if(I.skip_neutral_temps&&ve.deliverAt.getMinutes()>=55){if(!ur)return ve.reason+="; Canceling temp at "+(60-ve.deliverAt.getMinutes())+"min before turn of the hour to avoid beeping of MDT. SMB disabled anyways.",w.setTempBasal(0,0,I,ve,r);console.error(60-ve.deliverAt.getMinutes()+"min before turn of the hour, but SMB's are enabled - no skipping neutral temps")}var xa=0,Ia=Me;if(hr<Ge){if(ve.reason+="Eventual BG "+n(hr,I)+" < "+n(Ge,I),we>vr&&we>0&&!Sa)return fr<40?(ve.reason+=", naive_eventualBG < 40. ",w.setTempBasal(0,30,I,ve,r)):(e.delta>we?ve.reason+=", but Delta "+n(ye,I)+" > expectedDelta "+n(vr,I):ve.reason+=", but Min. Delta "+we.toFixed(2)+" > Exp. Delta "+n(vr,I),r.duration>15&&t(Me,I)===t(r.rate,I)?(ve.reason+=", temp "+r.rate+" ~ req "+Me+"U/hr. ",ve):(ve.reason+="; setting current basal of "+Me+" as temp. ",w.setTempBasal(Me,30,I,ve,r)));xa=o(xa=2*Math.min(0,(hr-Oe)/Ze),2);var Fa=Math.min(0,(fr-Oe)/Ze);if(Fa=o(Fa,2),we<0&&we>vr)xa=o(xa*(we/vr),2);if(Ia=t(Ia=Me+2*xa,I),r.duration*(r.rate-Me)/60<Math.min(xa,Fa)-.3*Me)return ve.reason+=", "+r.duration+"m@"+r.rate.toFixed(2)+" is a lot less than needed. ",w.setTempBasal(Ia,30,I,ve,r);if(void 0!==r.rate&&r.duration>5&&Ia>=.8*r.rate)return ve.reason+=", temp "+r.rate+" ~< req "+Ia+"U/hr. ",ve;if(Ia<=0){if((ya=o(60*((ga=Oe-fr)/Ze)/I.current_basal))<0?ya=0:(ya=30*o(ya/30),ya=Math.min(120,Math.max(0,ya))),ya>0)return ve.reason+=", setting "+ya+"m zero temp. ",w.setTempBasal(Ia,ya,I,ve,r)}else ve.reason+=", setting "+Ia+"U/hr. ";return w.setTempBasal(Ia,30,I,ve,r)}if(we<vr&&(!C||!ur))return e.delta<we?ve.reason+="Eventual BG "+n(hr,I)+" > "+n(Ge,I)+" but Delta "+n(ye,I)+" < Exp. Delta "+n(vr,I):ve.reason+="Eventual BG "+n(hr,I)+" > "+n(Ge,I)+" but Min. Delta "+we.toFixed(2)+" < Exp. Delta "+n(vr,I),r.duration>15&&t(Me,I)===t(r.rate,I)?(ve.reason+=", temp "+r.rate+" ~ req "+Me+"U/hr. ",ve):(ve.reason+="; setting current basal of "+Me+" as temp. ",w.setTempBasal(Me,30,I,ve,r));if(Math.min(hr,zr)<Re&&(!C||!ur))return ve.reason+=n(hr,I)+"-"+n(zr,I)+" in range: no temp required",r.duration>15&&t(Me,I)===t(r.rate,I)?(ve.reason+=", temp "+r.rate+" ~ req "+Me+"U/hr. ",ve):(ve.reason+="; setting current basal of "+Me+" as temp. ",w.setTempBasal(Me,30,I,ve,r));if(hr>=Re&&(ve.reason+="Eventual BG "+n(hr,I)+" >= "+n(Re,I)+", "),a.iob>Ae)return ve.reason+="IOB "+o(a.iob,2)+" > max_iob "+Ae,r.duration>15&&t(Me,I)===t(r.rate,I)?(ve.reason+=", temp "+r.rate+" ~ req "+Me+"U/hr. ",ve):(ve.reason+="; setting current basal of "+Me+" as temp. ",w.setTempBasal(Me,30,I,ve,r));xa=o((Math.min(zr,hr)-Oe)/Ze,2);var Ta=o((hr-Oe)/Ze,2);xa>Ae-a.iob&&(ve.reason+="max_iob "+Ae+", ",console.error("InsReq",o(xa,2),"capped at "+o(Ae-a.iob,2)+" to not exceed max_iob"),xa=Ae-a.iob),Ia=t(Ia=Me+2*xa,I),xa=o(xa,3),ve.insulinReq=xa,ve.insulinForManualBolus=Ta,ve.reason="Ins.Req: "+o(xa,2)+", "+ve.reason;var wa=o((new Date(Se).getTime()-a.lastBolusTime)/6e4,1);if(C&&ur&&Fe>Ye){var Ca=o(T.mealCOB/I.carb_ratio,3);if(I.use_autoisf)Da=I.smb_max_range_extension;else{console.error("autoISF disabled, SMB range extension disabled");var Da=1}Da>1&&console.error("SMB max range extended from default by factor "+Da);var Oa=0;void 0===I.maxSMBBasalMinutes?(Oa=o(Da*I.current_basal*30/60,1),console.error("profile.maxSMBBasalMinutes undefined: defaulting to 30m")):a.iob>Ca&&a.iob>0?(console.error("IOB",a.iob,"> COB",T.mealCOB+"; mealInsulinReq =",Ca),I.maxUAMSMBBasalMinutes?(console.error("profile.maxUAMSMBBasalMinutes:",I.maxUAMSMBBasalMinutes,"profile.current_basal:",I.current_basal),Oa=o(Da*I.current_basal*I.maxUAMSMBBasalMinutes/60,1)):(console.error("profile.maxUAMSMBBasalMinutes undefined: defaulting to 30m"),Oa=o(30*I.current_basal/60,1))):(console.error("profile.maxSMBBasalMinutes:",I.maxSMBBasalMinutes,"profile.current_basal:",I.current_basal),Oa=o(Da*I.current_basal*I.maxSMBBasalMinutes/60,1));var Ga=I.bolus_increment,Ra=1/Ga;I.use_autoisf||(console.error("autoISF disabled, don't adjust SMB Delivery Ratio"),ca=.5),ca>.5&&console.error("SMB Delivery Ratio increased from default 0.5 to "+o(ca,2));var Ua=Math.min(xa*ca,Oa);Ua=Math.floor(Ua*Ra)/Ra,ya=o(60*((Oe-(fr+Hr)/2)/Ze)/I.current_basal),xa>0&&Ua<Ga&&(ya=0);var Aa=0;ya<=0?ya=0:ya>=30?(ya=30*o(ya/30),ya=Math.min(60,Math.max(0,ya))):(Aa=o(Me*ya/30,2),ya=30),Ua>=Oa&&(ve.reason+="; maxBolus "+Oa),ya>0&&(ve.reason+="; setting "+ya+"m low temp of "+Aa+"U/h"),ve.reason+=". ";var Ea=3;I.SMBInterval&&(Ea=Math.min(10,Math.max(1,I.SMBInterval)));var Pa=o(Ea-wa,0),ka=o(60*(Ea-wa),0)%60;if(console.error("naive_eventualBG "+n(fr,I)+", "+ya+"m "+Aa+"U/h temp needed; last bolus "+wa+"m ago; maxBolus: "+Oa),wa>Ea?Ua>0&&(ve.units=Ua,ve.reason+="Microbolusing "+Ua+"U. "):ve.reason+="Waiting "+Pa+"m "+ka+"s to microbolus again. ",ya>0)return ve.rate=Aa,ve.duration=ya,ve}var ja=w.getMaxSafeBasal(I);return Ia>ja&&(ve.reason+="adj. req. rate: "+o(Ia,2)+" to maxSafeBasal: "+o(ja,2)+", ",Ia=t(ja,I)),r.duration*(r.rate-Me)/60>=2*xa?(ve.reason+=r.duration+"m@"+r.rate.toFixed(2)+" > 2 * insulinReq. Setting temp basal of "+Ia+"U/hr. ",w.setTempBasal(Ia,30,I,ve,r)):void 0===r.duration||0===r.duration?(ve.reason+="no temp, setting "+Ia+"U/hr. ",w.setTempBasal(Ia,30,I,ve,r)):r.duration>5&&t(Ia,I)<=t(r.rate,I)?(ve.reason+="temp "+r.rate+" >~ req "+Ia+"U/hr. ",ve):(ve.reason+="temp "+r.rate+"<"+Ia+"U/hr. ",w.setTempBasal(Ia,30,I,ve,r))}},6880:(e,r,a)=>{var t=a(6654);e.exports=function(e,r){var a=20;void 0!==r&&"string"==typeof r.model&&(t(r.model,"54")||t(r.model,"23"))&&(a=40);return e<1?Math.round(e*a)/a:e<10?Math.round(20*e)/20:Math.round(10*e)/10}},2705:(e,r,a)=>{var t=a(5639).Symbol;e.exports=t},9932:e=>{e.exports=function(e,r){for(var a=-1,t=null==e?0:e.length,o=Array(t);++a<t;)o[a]=r(e[a],a,e);return o}},9750:e=>{e.exports=function(e,r,a){return e==e&&(void 0!==a&&(e=e<=a?e:a),void 0!==r&&(e=e>=r?e:r)),e}},4239:(e,r,a)=>{var t=a(2705),o=a(9607),n=a(2333),i=t?t.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?o(e):n(e)}},531:(e,r,a)=>{var t=a(2705),o=a(9932),n=a(1469),i=a(3448),s=t?t.prototype:void 0,l=s?s.toString:void 0;e.exports=function e(r){if("string"==typeof r)return r;if(n(r))return o(r,e)+"";if(i(r))return l?l.call(r):"";var a=r+"";return"0"==a&&1/r==-Infinity?"-0":a}},7561:(e,r,a)=>{var t=a(7990),o=/^\s+/;e.exports=function(e){return e?e.slice(0,t(e)+1).replace(o,""):e}},1957:(e,r,a)=>{var t="object"==typeof a.g&&a.g&&a.g.Object===Object&&a.g;e.exports=t},9607:(e,r,a)=>{var t=a(2705),o=Object.prototype,n=o.hasOwnProperty,i=o.toString,s=t?t.toStringTag:void 0;e.exports=function(e){var r=n.call(e,s),a=e[s];try{e[s]=void 0;var t=!0}catch(e){}var o=i.call(e);return t&&(r?e[s]=a:delete e[s]),o}},2333:e=>{var r=Object.prototype.toString;e.exports=function(e){return r.call(e)}},5639:(e,r,a)=>{var t=a(1957),o="object"==typeof self&&self&&self.Object===Object&&self,n=t||o||Function("return this")();e.exports=n},7990:e=>{var r=/\s/;e.exports=function(e){for(var a=e.length;a--&&r.test(e.charAt(a)););return a}},6654:(e,r,a)=>{var t=a(9750),o=a(531),n=a(554),i=a(9833);e.exports=function(e,r,a){e=i(e),r=o(r);var s=e.length,l=a=void 0===a?s:t(n(a),0,s);return(a-=r.length)>=0&&e.slice(a,l)==r}},1469:e=>{var r=Array.isArray;e.exports=r},3218:e=>{e.exports=function(e){var r=typeof e;return null!=e&&("object"==r||"function"==r)}},7005:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},3448:(e,r,a)=>{var t=a(4239),o=a(7005);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==t(e)}},8601:(e,r,a)=>{var t=a(4841),o=1/0;e.exports=function(e){return e?(e=t(e))===o||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},554:(e,r,a)=>{var t=a(8601);e.exports=function(e){var r=t(e),a=r%1;return r==r?a?r-a:r:0}},4841:(e,r,a)=>{var t=a(7561),o=a(3218),n=a(3448),i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(n(e))return NaN;if(o(e)){var r="function"==typeof e.valueOf?e.valueOf():e;e=o(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=t(e);var a=s.test(e);return a||l.test(e)?u(e.slice(2),a?2:8):i.test(e)?NaN:+e}},9833:(e,r,a)=>{var t=a(531);e.exports=function(e){return null==e?"":t(e)}}},r={};function a(t){var o=r[t];if(void 0!==o)return o.exports;var n=r[t]={exports:{}};return e[t](n,n.exports,a),n.exports}a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var t=a(5546);freeaps_determineBasal=t})();